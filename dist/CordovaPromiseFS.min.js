var CordovaPromiseFS=function(n){function e(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return n[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=n,e.c=t,e.p="",e(0)}([function(n){function e(n,t,r,o){n.getDirectory(t[0],{create:!0},function(n){t.length>1?e(n,t.slice(1),r,o):r(n)},o)}function t(n){var e=n.split("/");return e.length>1?(e.splice(e.length-1,1),e.join("/")):""}function r(n){var e=n.split("/");return e[e.length-1]}var o=[],i=0;n.exports=function(n){function u(n){return c(t(n)).then(function(){return l(n,{create:!0})})}function c(n){return new L(function(t,r){return U.then(function(o){n?(n=n.split("/").filter(function(n){return n&&n.length>0&&"."!==n[0]}),e(o.root,n,t,r)):t(o.root)},r)})}function f(n){return new L(function(e,t){l(n).then(function(n){e(n)},function(n){1===n.code?e(!1):t(n)})})}function s(n){return l(n).then(function(n){return n.toURL()})}function a(n){return p(n,"readAsDataURL")}function l(n,e){return e=e||{},new L(function(t,r){return U.then(function(o){o.root.getFile(n,e,t,r)},r)})}function d(n,e){return e=e||{},new L(function(t,r){return U.then(function(o){n&&"/"!==n?o.root.getDirectory(n,e,t,r):t(o.root)},r)})}function p(n,e){return e=e||"readAsText",l(n).then(function(n){return new L(function(t,r){n.file(function(n){var r=new FileReader;r.onloadend=function(){t(this.result)},r[e](n)},r)})})}function h(n){return p(n).then(JSON.parse)}function y(n,e,r){return c(t(n)).then(function(){return l(n,{create:!0})}).then(function(n){return new L(function(t,o){n.createWriter(function(n){n.onwriteend=t,n.onerror=o,"string"==typeof e?e=new Blob([e],{type:r||"text/plain"}):e instanceof Blob!=!0&&(e=new Blob([JSON.stringify(e,null,4)],{type:r||"application/json"})),n.write(e)},o)})})}function w(n,e){return c(t(e)).then(function(t){return l(n).then(function(n){return new L(function(o,i){n.moveTo(t,r(e),o,i)})})})}function v(n,e){return c(t(e)).then(function(t){return l(n).then(function(n){return new L(function(o,i){n.copyTo(t,r(e),o,i)})})})}function m(n,e){var t=e?l:f;return new L(function(e,r){t(n).then(function(n){n!==!1?n.remove(e,r):e()},r)})}function g(n){return d(n).then(function(n){return new L(function(e,t){n.removeRecursively(e,t)})})}function S(n,e){e=e||"";var t=e.indexOf("r")>-1,r=e.indexOf("e")>-1,o=e.indexOf("f")>-1,i=e.indexOf("d")>-1;return o&&i&&(o=!1,i=!1),new L(function(e,u){return d(n).then(function(n){var c=n.createReader();c.readEntries(function(n){var c=[L.resolve(n)];t&&n.filter(function(n){return n.isDirectory}).forEach(function(n){c.push(S(n.fullPath,"re"))}),L.all(c).then(function(n){var t=[];t=t.concat.apply(t,n),o&&(t=t.filter(function(n){return n.isFile})),i&&(t=t.filter(function(n){return n.isDirectory})),r||(t=t.map(function(n){return n.fullPath})),e(t)},u)},u)},u)})}function F(){for(;o.length>0&&i<n.concurrency;){i++;var e=o.pop(),t=e.shift(),r=e.shift(),u=e.shift(),c=e.shift(),f=e.shift(),s=e.shift(),a=e.shift(),l=e.shift();t._aborted?i--:r?(t.download.call(t,u,c,f,s,a,l),t.onprogress&&t.onprogress(new ProgressEvent)):t.upload.call(t,c,u,f,s,l,a)}}function R(n){return i--,F(),n}function x(e,t,r,u,c){"function"==typeof u&&(c=u,u={}),t=encodeURI(t),P&&(r=D(r)),u=u||{},u.retry&&u.retry.length||(u.retry=n.retry),u.retry=u.retry.concat();var f=new FileTransfer;"function"==typeof c&&(f.onprogress=c);var s=new L(function(n,c){var s=function(i){if(0===u.retry.length)c(i);else{o.unshift([f,e,t,r,n,s,u.trustAllHosts||!1,u]);var a=u.retry.shift();a>0?setTimeout(R,a):R()}};u.retry.unshift(0),i++,s()});return s.then(R,R),s.progress=function(n){return f.onprogress=n,s},s.abort=function(){return f._aborted=!0,f.abort(),s},s}function T(n,e,t,r){return x(!0,n,e,t,r)}function b(n,e,t,r){return x(!1,e,n,t,r)}var L=n.Promise||window.Promise;if(!L)throw new Error("No Promise library given in options.Promise");this.options=n=n||{},n.persistent=void 0!==n.persistent?n.persistent:!0,n.storageSize=n.storageSize||20971520,n.concurrency=n.concurrency||3,n.retry=n.retry||[];var E,P="undefined"!=typeof cordova;P?E=new L(function(n,e){document.addEventListener("deviceready",n,!1),setTimeout(function(){e(new Error("deviceready has not fired after 5 seconds."))},5100)}):(E=L.resolve(),"undefined"!=typeof webkitRequestFileSystem?(window.requestFileSystem=webkitRequestFileSystem,window.FileTransfer=function(){},FileTransfer.prototype.download=function(n,e,t,r){var o=new XMLHttpRequest;return o.open("GET",n),o.onreadystatechange=function(){4==o.readyState&&(200===o.status?y(e,o.responseText).then(t,r):r(o.status))},o.send(),o}):window.requestFileSystem=function(n,e,t,r){r(new Error("requestFileSystem not supported!"))});var U=new L(function(e,t){E.then(function(){window.requestFileSystem(n.persistent?1:0,n.storageSize,e,t),setTimeout(function(){t(new Error("Could not retrieve FileSystem after 5 seconds."))},5100)},t)});U.then(function(n){window.__fs=n},function(n){console.error("Could not get Cordova FileSystem:",n)});var q,D;return P?(D=function(e){return"/"!==e[0]&&(e="/"+e),"cdvfile://localhost/"+(n.persistent?"persistent":"temporary")+e},q=function(n){return l(n).then(function(n){return n.toInternalURL()})}):(D=function(e){return"/"!==e[0]&&(e="/"+e),"filesystem:"+location.origin+(n.persistent?"/persistent":"/temporary")+e},q=function(n){return l(n).then(function(n){return n.toURL()})}),{fs:U,file:l,filename:r,dir:d,dirname:t,create:u,read:p,readJSON:h,write:y,move:w,copy:v,remove:m,removeDir:g,list:S,ensure:c,exists:f,download:T,upload:b,toURL:s,isCordova:P,toInternalURLSync:D,toInternalURL:q,toDataURL:a,deviceready:E,options:n,Promise:L}}}]);